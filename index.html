<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Birthday Wishes â€“ Pravallika Vadla</title>

<style>
  body {
    margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    text-align: center; color: #333; overflow-x: hidden;
  }
  
  .page { display: none; min-height: 100vh; padding: 60px 20px; box-sizing: border-box; }
  .page.active { display: block; }

  /* UI Elements */
  .countdown { font-size: 32px; font-weight: bold; margin: 20px auto; display: block; }
  #lockMessage { color: #d63384; font-weight: bold; margin-bottom: 10px; }

  button {
    padding: 14px 30px; border-radius: 30px; border: none;
    background: linear-gradient(45deg, #ff4d6d, #ff758c);
    color: white; font-size: 18px; font-weight: bold; cursor: pointer;
    box-shadow: 0 4px 15px rgba(230, 57, 80, 0.3);
    transition: 0.3s; margin: 10px;
  }
  button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(230, 57, 80, 0.4); }
  button:disabled { background: #aaa; cursor: not-allowed; box-shadow: none; opacity: 0.6; }

  /* Input Group */
  .input-group {
    background: rgba(255, 255, 255, 0.9);
    padding: 30px; border-radius: 25px;
    max-width: 450px; margin: 20px auto;
    box-shadow: 0 15px 35px rgba(0,0,0,0.1);
  }
  input, textarea { width: 90%; padding: 10px; margin: 8px 0; border: 2px solid #ffe5ec; border-radius: 10px; outline: none; }

  /* Sticky Notes */
  #messages-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; padding: 40px; }
  .wish-card {
    background: linear-gradient(135deg, #ffff88 0%, #ffef55 100%);
    width: 260px; min-height: 280px; padding: 20px;
    box-shadow: 5px 10px 15px rgba(0,0,0,0.15);
    text-align: left; position: relative; display: flex; flex-direction: column;
  }
  .reply-box { margin-top: 10px; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 10px; }
  .reply-list { font-size: 12px; color: #555; max-height: 80px; overflow-y: auto; }
  .reply-input-wrapper { display: flex; gap: 5px; margin-top: 5px; }
  .reply-input { font-size: 11px; padding: 5px; flex-grow: 1; margin: 0; }

  /* Scavenger Hunt */
  .scavenger-item { cursor: pointer; font-size: 40px; position: absolute; z-index: 1000; filter: drop-shadow(0 0 10px gold); animation: pulse 1s infinite alternate; }
  @keyframes pulse { from { transform: scale(1); } to { transform: scale(1.3); } }
  .scavenger-item.found { display: none; }

  /* Background Effect */
  .effect { position: fixed; top: -50px; animation: fall linear infinite; z-index: 10; pointer-events: none; }
  @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }

  .slideshow img { width: 300px; height: 300px; object-fit: cover; border-radius: 20px; position: absolute; left: 0; opacity: 0; transition: opacity 1s; }
  .slideshow img.active { opacity: 1; }
</style>
</head>
<body>

<audio id="bgMusic" loop><source src="https://www.orangefreesounds.com/wp-content/uploads/2016/08/Happy-birthday-instrumental.mp3" type="audio/mpeg"></audio>

<div class="page active" id="page1">
  <h1 id="mainTitle">ğŸ‰ Countdown to the Big Day ğŸ‰</h1>
  <div class="countdown" id="countdown">Loading...</div>
  <p id="lockMessage">Locked until the Birthday begins! ğŸ”’</p>
  <button id="entryBtn" onclick="goToPage(2)" disabled>Go to Birthday Wishes ğŸ‚</button>
  <div id="friendsOnly" style="display:none; margin-top: 20px;">
      <p>Hey Friend! You are here early to leave a wish. âœ¨</p>
      <button onclick="goToPage(4)">Go to Message Board âœï¸</button>
  </div>
</div>

<div class="page" id="page2">
  <h1>Happy Birthday, Pravallika! ğŸ’–</h1>
  <div id="typewriter" style="max-width:600px; margin:auto; font-size:18px;"></div>
  <div class="slideshow" style="margin: 30px auto; position: relative; height: 320px; width: 300px;">
    <img class="active" src="https://via.placeholder.com/300/FFB6C1/FFFFFF?text=Memory+1">
    <img src="https://via.placeholder.com/300/FF69B4/FFFFFF?text=Memory+2">
    <img src="https://via.placeholder.com/300/DB7093/FFFFFF?text=Memory+3">
  </div>
  <p id="starTracker" style="font-weight:bold; color:#ff4d6d;">Stars Found: 0/3</p>
  <button onclick="goToPage(4)">Go to Message Board âœï¸</button>
</div>

<div class="page" id="page4">
  <h1>ğŸ“– Friends' Wishes</h1>
  <div class="input-group">
    <input type="text" id="senderName" placeholder="Your Name">
    <textarea id="senderMsg" rows="2" placeholder="Write your wish..."></textarea>
    <button id="postBtn">Send Wish ğŸ’Œ</button>
  </div>
  <button id="unlockWheelBtn" onclick="goToPage(3)" style="display:none; background:#4CAF50;">âœ¨ Go to Gift Wheel ğŸ¡ âœ¨</button>
  <div id="messages-container"></div>
</div>

<div class="page" id="page3">
  <h1>ğŸ¡ The Birthday Gift Wheel ğŸ¡</h1>
  <canvas id="wheelCanvas" width="400" height="400"></canvas><br>
  <button id="spinBtn" onclick="spinWheel()">Spin for a Gift!</button>
  <h2 id="giftResult"></h2>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCgWYC7M9MdvFEpgSkNIrnXUlf57_YeTb4",
    authDomain: "pravallikabirthday-eea91.firebaseapp.com",
    databaseURL: "https://pravallikabirthday-eea91-default-rtdb.firebaseio.com",
    projectId: "pravallikabirthday-eea91",
    storageBucket: "pravallikabirthday-eea91.firebasestorage.app",
    messagingSenderId: "742416208965",
    appId: "1:742416208965:web:34152005176d9f4ead3f2c"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const messagesRef = ref(db, 'wishes');

  window.sendReply = (id) => {
    const input = document.getElementById(`reply-input-${id}`);
    if(input.value.trim()) {
      push(ref(db, `wishes/${id}/replies`), input.value);
      input.value = '';
    }
  };

  document.getElementById('postBtn').onclick = () => {
    const name = document.getElementById('senderName').value;
    const msg = document.getElementById('senderMsg').value;
    if(name && msg) {
      push(messagesRef, { name, msg, time: Date.now() });
      document.getElementById('senderName').value = '';
      document.getElementById('senderMsg').value = '';
    }
  };

  onValue(messagesRef, (snap) => {
    const cont = document.getElementById('messages-container');
    cont.innerHTML = '';
    const data = snap.val();
    if(data) {
      Object.keys(data).reverse().forEach(id => {
        const w = data[id];
        let repliesHtml = '';
        if(w.replies) Object.values(w.replies).forEach(r => { repliesHtml += `<div style="padding:2px 0;">ğŸ’¬ ${r}</div>`; });
        cont.innerHTML += `<div class="wish-card"><h3>${w.name}</h3><p>${w.msg}</p><div class="reply-box"><div class="reply-list">${repliesHtml}</div><div class="reply-input-wrapper"><input type="text" class="reply-input" id="reply-input-${id}" placeholder="Reply..."><button onclick="sendReply('${id}')" style="padding:2px 5px; font-size:10px;">Go</button></div></div><span onclick="this.innerHTML='â¤ï¸'">ğŸ¤</span></div>`;
      });
    }
  });
</script>

<script>
/* URL MODE LOGIC */
const urlParams = new URLSearchParams(window.location.search);
const isFriendMode = urlParams.get('mode') === 'friends';

if(isFriendMode) {
    document.getElementById('lockMessage').style.display = 'none';
    document.getElementById('friendsOnly').style.display = 'block';
    document.getElementById('mainTitle').innerText = "Friend's Access ğŸ”‘";
}

/* Countdown Logic */
const target = new Date('Feb 14, 2026 00:00:00').getTime();
const timerInterval = setInterval(() => {
  const diff = target - Date.now();
  if (diff <= 0) {
    clearInterval(timerInterval);
    document.getElementById('countdown').innerHTML = "ğŸ‰ HAPPY BIRTHDAY! ğŸ‰";
    document.getElementById('entryBtn').disabled = false;
    document.getElementById('lockMessage').style.display = 'none';
  } else {
    const d = Math.floor(diff/86400000), h = Math.floor(diff/3600000)%24, m = Math.floor(diff/60000)%60, s = Math.floor(diff/1000)%60;
    document.getElementById('countdown').innerHTML = `${d}d ${h}h ${m}m ${s}s`;
  }
}, 1000);

/* Navigation */
function goToPage(num) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page'+num).classList.add('active');
  if(num >= 2) document.getElementById('bgMusic').play().catch(()=>{});
  if(num === 2) startTypewriter();
  window.scrollTo(0,0);
}

/* Background Effects */
const icons=['ğŸ‰','ğŸ’–','ğŸŒ¸','ğŸ’','â¤ï¸'];
setInterval(()=>{
  const e=document.createElement('div'); e.className='effect';
  e.innerText=icons[Math.floor(Math.random()*icons.length)];
  e.style.left=Math.random()*100+'vw'; e.style.animationDuration=5+Math.random()*5+'s';
  document.body.appendChild(e); setTimeout(()=>e.remove(),10000);
},300);

/* Scavenger Hunt */
let starsFound = 0;
function collectStar(el) {
  if (!el.classList.contains('found')) {
    el.classList.add('found');
    starsFound++;
    document.getElementById('starTracker').innerText = `Stars Found: ${starsFound}/3`;
    if (starsFound === 3) document.getElementById('unlockWheelBtn').style.display = 'inline-block';
  }
}
function placeScavengerStars() {
  const spots = [{p:'page1',t:'20%',l:'10%'}, {p:'page2',t:'85%',l:'80%'}, {p:'page4',t:'75%',l:'15%'}];
  spots.forEach(s => {
    const star = document.createElement('div');
    star.className = 'scavenger-item'; star.innerHTML = 'â­';
    star.style.top = s.t; star.style.left = s.l;
    star.onclick = () => collectStar(star);
    document.getElementById(s.p).appendChild(star);
  });
}

/* Typewriter & Slideshow & Wheel logic remains as previously provided... */
function startTypewriter() {
  const el = document.getElementById('typewriter');
  if(el.innerHTML !== "") return;
  const str = "Happy Birthday Pravallika! ğŸ‰ You are a ray of sunshine... âœ¨ğŸ’–";
  let i = 0;
  function type() { if(i < str.length) { el.innerHTML += str.charAt(i++); setTimeout(type, 50); } }
  type();
}
let sIdx = 0;
setInterval(() => {
  const imgs = document.querySelectorAll('.slideshow img');
  if(imgs.length > 0) {
    imgs[sIdx].classList.remove('active');
    sIdx = (sIdx + 1) % imgs.length;
    imgs[sIdx].classList.add('active');
  }
}, 3000);
// (Wheel drawing functions go here - shortened for space but identical to previous)
const gifts = ["Chocolates ğŸ«", "Teddy ğŸ§¸", "Hand Bag ğŸ‘œ", "Try Again ğŸ”„", "Surprise ğŸ", "Speaker ğŸ”Š"];
const canvas = document.getElementById("wheelCanvas");
const ctx = canvas.getContext("2d");
function drawWheel(rot = 0) {
  const arc = Math.PI*2/6;
  for(let i=0; i<6; i++) {
    ctx.beginPath(); ctx.fillStyle = ["#ffbe0b","#fb5607","#ff006e","#8338ec","#3a86ff","#06d6a0"][i];
    ctx.moveTo(200,200); ctx.arc(200,200,190, i*arc+rot, (i+1)*arc+rot); ctx.fill();
  }
}
drawWheel(0);
function spinWheel() {
  let start = performance.now(), duration = 4000, totalRot = Math.random()*360 + 1440;
  function animate(t) {
    let prog = Math.min((t-start)/duration, 1), ease = 1-Math.pow(1-prog,3);
    drawWheel(totalRot * ease * Math.PI/180);
    if(prog < 1) requestAnimationFrame(animate);
    else document.getElementById('giftResult').innerText = "Winner!";
  }
  requestAnimationFrame(animate);
}

window.onload = placeScavengerStars;
</script>
</body>
</html>