<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Birthday Wishes â€“ Pravallika Vadla</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<style>
  body {
    margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    text-align: center; color: #333; overflow-x: hidden;
  }
  
  .page { display: none; min-height: 100vh; padding: 40px 10px; box-sizing: border-box; }
  .page.active { display: block; }

  button {
    padding: 14px 30px; border-radius: 30px; border: none;
    background: linear-gradient(45deg, #ff4d6d, #ff758c);
    color: white; font-size: 18px; font-weight: bold; cursor: pointer;
    box-shadow: 0 4px 15px rgba(230, 57, 80, 0.3);
    transition: 0.3s; margin: 10px; position: relative; z-index: 100;
  }
  button:disabled { background: #aaa; cursor: not-allowed; opacity: 0.7; }

  /* Typewriter Area */
  #typewriter {
    max-width: 600px; margin: 20px auto; font-size: 18px; 
    line-height: 1.6; min-height: 80px; font-style: italic; padding: 0 15px;
  }

  /* POLAROID STACK */
  .swiper { width: 300px; height: 380px; padding: 20px; margin: 10px auto; }
  .swiper-slide {
    background: white; border-radius: 5px; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    display: flex; flex-direction: column; align-items: center;
    padding: 12px; box-sizing: border-box; border: 1px solid #ddd;
  }
  .swiper-slide img { width: 100%; height: 260px; object-fit: cover; border: 1px solid #eee; }
  .polaroid-caption { font-family: 'Brush Script MT', cursive; font-size: 20px; margin-top: 10px; color: #444; }

  /* UI & Database Elements */
  .countdown { font-size: 32px; font-weight: bold; margin: 20px auto; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
  .input-group { background: rgba(255,255,255,0.9); padding: 20px; border-radius: 20px; max-width: 400px; margin: 20px auto; }
  input, textarea { width: 90%; padding: 10px; margin: 5px 0; border-radius: 10px; border: 1px solid #ddd; outline: none; }
  
  #messages-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }
  .wish-card { background: #ffff88; width: 250px; padding: 15px; box-shadow: 5px 5px 15px rgba(0,0,0,0.1); text-align: left; position: relative; }
  
  .effect { position: fixed; top: -50px; animation: fall linear infinite; z-index: 10; pointer-events: none; }
  @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
  .scavenger-item { cursor: pointer; font-size: 40px; position: absolute; z-index: 1000; }
  .scavenger-item.found { display: none; }

  /* Music Toggle Button */
  #musicToggle {
    position: fixed; bottom: 20px; right: 20px; z-index: 200;
    width: 50px; height: 50px; border-radius: 50%; background: white;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 24px;
  }
</style>
</head>
<body>

<audio id="bgMusic" loop><source src="https://www.orangefreesounds.com/wp-content/uploads/2016/08/Happy-birthday-instrumental.mp3" type="audio/mpeg"></audio>

<div id="musicToggle" onclick="toggleMusic()">ğŸµ</div>

<div class="page active" id="page1">
  <h1 id="mainTitle">ğŸ‰ Countdown to the Big Day ğŸ‰</h1>
  <div class="countdown" id="countdown">Loading...</div>
  <p id="lockMessage" style="color: white; font-weight: bold;">Locked until Feb 14th ğŸ”’</p>
  <button id="entryBtn" onclick="goToPage(2)" disabled>Go to Birthday Wishes ğŸ‚</button>
  
  <div id="friendsOnly" style="display:none; margin-top: 20px; border-top: 1px dashed white; padding-top: 20px;">
      <p style="color: white; font-weight: bold;">Special Guest Access Unlocked! âœ¨</p>
      <button onclick="goToPage(2)" style="background: #4CAF50;">Enter Guest Book ğŸˆ</button>
  </div>
</div>

<div class="page" id="page2">
  <h1>Happy Birthday, Pravallika! ğŸ’–</h1>
  <div id="typewriter"></div>

  <div class="swiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide"><img src="https://via.placeholder.com/300x300?text=Photo+1"><div class="polaroid-caption">Memory 1 âœ¨</div></div>
      <div class="swiper-slide"><img src="https://via.placeholder.com/300x300?text=Photo+2"><div class="polaroid-caption">Memory 2 ğŸ˜Š</div></div>
      <div class="swiper-slide"><img src="https://via.placeholder.com/300x300?text=Photo+3"><div class="polaroid-caption">Memory 3 ğŸ¥‚</div></div>
    </div>
  </div>

  <p id="starTracker" style="font-weight:bold; color: #ff4d6d;">Stars Found: 0/3</p>

  <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.5); margin: 40px 0;">

  <h2 id="boardTitle">ğŸ“– The Wish Board</h2>
  <div class="input-group">
    <input type="text" id="senderName" placeholder="Your Name">
    <textarea id="senderMsg" rows="2" placeholder="Write something sweet..."></textarea>
    <button id="postBtn">Send Wish ğŸ’Œ</button>
  </div>
  
  <button id="unlockWheelBtn" onclick="goToPage(3)" style="display:none; background:#4CAF50; margin-bottom: 20px;">âœ¨ UNLOCKED: Go to Gift Wheel ğŸ¡ âœ¨</button>

  <div id="messages-container"></div>
</div>

<div class="page" id="page3">
  <h1>ğŸ¡ The Birthday Gift Wheel ğŸ¡</h1>
  <canvas id="wheelCanvas" width="350" height="350" style="margin:auto; display:block;"></canvas><br>
  <button id="spinBtn" onclick="spinWheel()">Spin for a Gift!</button>
  <h2 id="giftResult"></h2>
  <button onclick="goToPage(2)">Back to Board ğŸ”™</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCgWYC7M9MdvFEpgSkNIrnXUlf57_YeTb4",
    authDomain: "pravallikabirthday-eea91.firebaseapp.com",
    databaseURL: "https://pravallikabirthday-eea91-default-rtdb.firebaseio.com",
    projectId: "pravallikabirthday-eea91",
    storageBucket: "pravallikabirthday-eea91.firebasestorage.app",
    messagingSenderId: "742416208965",
    appId: "1:742416208965:web:34152005176d9f4ead3f2c"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const messagesRef = ref(db, 'wishes');

  document.getElementById('postBtn').onclick = () => {
    const name = document.getElementById('senderName').value;
    const msg = document.getElementById('senderMsg').value;
    if(name && msg) {
      push(messagesRef, { name, msg });
      document.getElementById('senderName').value = '';
      document.getElementById('senderMsg').value = '';
      confetti({ particleCount: 100, spread: 70, origin: { y: 0.8 } });
    }
  };

  onValue(messagesRef, (snap) => {
    const cont = document.getElementById('messages-container');
    cont.innerHTML = '';
    const data = snap.val();
    if(data) {
      Object.keys(data).reverse().forEach(id => {
        const w = data[id];
        cont.innerHTML += `<div class="wish-card"><h3>${w.name}</h3><p>${w.msg}</p></div>`;
      });
    }
  });
</script>

<script>
let swiperInstance = null;
let starsFound = 0;
let musicPlaying = false;

function toggleMusic() {
    const audio = document.getElementById('bgMusic');
    const btn = document.getElementById('musicToggle');
    if (musicPlaying) {
        audio.pause();
        btn.innerText = "ğŸ”‡";
    } else {
        audio.play();
        btn.innerText = "ğŸµ";
    }
    musicPlaying = !musicPlaying;
}

function goToPage(num) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page'+num).classList.add('active');
  
  if(num >= 2 && !musicPlaying) {
    toggleMusic();
  }
  
  if(num === 2) {
    startTypewriter();
    if(!swiperInstance) {
      swiperInstance = new Swiper('.swiper', {
        effect: 'cards',
        grabCursor: true,
        loop: true
      });
    }
  }
  window.scrollTo(0,0);
}

function startTypewriter() {
  const el = document.getElementById('typewriter');
  if(el.innerHTML !== "") return;
  const str = "Happy Birthday to the amazing Pravallika! ğŸ‚ You truly make the world a brighter and more beautiful place just by being yourself. âœ¨ğŸ’– May your day be overflowing with as much love, laughter, and magic as you generously give to everyone around you! ğŸŒ¸ğŸ¥‚ I hope this year brings you endless joy and the fulfillment of all your biggest dreams. ğŸŒŸğŸˆ Keep shining like the star you are! ğŸ’ğŸ’•";
  let i = 0;
  function type() {
    if(i < str.length) {
      el.innerHTML += str.charAt(i++);
      setTimeout(type, 50);
    }
  }
  type();
}

// Mode Logic
if(new URLSearchParams(window.location.search).get('mode') === 'friends') {
    document.getElementById('friendsOnly').style.display = 'block';
    document.getElementById('lockMessage').innerText = "Guest Access Enabled âœ…";
}

// Timer Logic
const target = new Date('Feb 14, 2026 00:00:00').getTime();
setInterval(() => {
  const diff = target - Date.now();
  if (diff <= 0) {
    document.getElementById('countdown').innerHTML = "ğŸ‰ HAPPY BIRTHDAY! ğŸ‰";
    document.getElementById('entryBtn').disabled = false;
  } else {
    const d = Math.floor(diff/86400000), h = Math.floor(diff/3600000)%24, m = Math.floor(diff/60000)%60, s = Math.floor(diff/1000)%60;
    document.getElementById('countdown').innerHTML = `${d}d ${h}h ${m}m ${s}s`;
  }
}, 1000);

// Scavenger Hunt
function collectStar(el) {
  if (!el.classList.contains('found')) {
    el.classList.add('found');
    starsFound++;
    document.getElementById('starTracker').innerText = `Stars Found: ${starsFound}/3`;
    confetti({ particleCount: 50 });
    if (starsFound === 3) document.getElementById('unlockWheelBtn').style.display = 'inline-block';
  }
}

function placeStars() {
  const spots = [{p:'page1',t:'10%',l:'10%'}, {p:'page2',t:'40%',l:'85%'}, {p:'page2',t:'90%',l:'10%'}];
  spots.forEach(s => {
    const star = document.createElement('div');
    star.className = 'scavenger-item'; star.innerHTML = 'â­';
    star.style.top = s.t; star.style.left = s.l;
    star.onclick = () => collectStar(star);
    document.getElementById(s.p).appendChild(star);
  });
}

// Background Icons
const icons=['ğŸ‰','ğŸ’–','ğŸŒ¸','ğŸ’','â¤ï¸'];
setInterval(()=>{
  const e=document.createElement('div'); e.className='effect';
  e.innerText=icons[Math.floor(Math.random()*icons.length)];
  e.style.left=Math.random()*100+'vw'; e.style.animationDuration=5+Math.random()*5+'s';
  document.body.appendChild(e); setTimeout(()=>e.remove(),10000);
},400);

// Wheel
const gifts = ["Chocolates ğŸ«", "Teddy ğŸ§¸", "Hand Bag ğŸ‘œ", "Try Again ğŸ”„", "Surprise ğŸ", "Speaker ğŸ”Š"];
const canvas = document.getElementById("wheelCanvas");
const ctx = canvas.getContext("2d");
function drawWheel(rot = 0) {
  const arc = Math.PI*2/6;
  for(let i=0; i<6; i++) {
    ctx.beginPath(); ctx.fillStyle = ["#ffbe0b","#fb5607","#ff006e","#8338ec","#3a86ff","#06d6a0"][i];
    ctx.moveTo(175,175); ctx.arc(175,175,170, i*arc+rot, (i+1)*arc+rot); ctx.fill();
    ctx.save(); ctx.translate(175,175); ctx.rotate(i*arc+rot+arc/2);
    ctx.textAlign="right"; ctx.fillStyle="#fff"; ctx.font="bold 14px Arial"; ctx.fillText(gifts[i], 160, 5); ctx.restore();
  }
}
drawWheel(0);
function spinWheel() {
  let start = performance.now(), duration = 4000, totalRot = Math.random()*360 + 1440;
  document.getElementById('spinBtn').disabled = true;
  function animate(t) {
    let prog = Math.min((t-start)/duration, 1), ease = 1-Math.pow(1-prog,3);
    drawWheel(totalRot * ease * Math.PI/180);
    if(prog < 1) requestAnimationFrame(animate);
    else {
        document.getElementById('giftResult').innerText = "Winner! ğŸ‰";
        confetti({ particleCount: 200, spread: 100 });
        let final = (totalRot % 360), idx = Math.floor((360-final)/60)%6;
        if(gifts[idx].includes("Try Again")) document.getElementById('spinBtn').disabled = false;
    }
  }
  requestAnimationFrame(animate);
}

window.onload = placeStars;
</script>
</body>
</html>
